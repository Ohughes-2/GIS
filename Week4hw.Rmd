---
title: "Week4hw"
author: "Owen Hughes"
date: "2025-10-22"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
```{r}
print('Okay!! I Want to Load the World Data and Gender Inequality Data, Make a New Column
      Displaying the Difference Between 2010 and 2019, Save to GitHub, and Add my GitHub
      URL to the spreadsheet')
print('The First Step is to Load the Packeges that I Think I Might Need')
library(sf)
library(here)
library(janitor)
library(tidyverse)
```


```{r}
library(ggplot2)
```
```{r}
print("Let's read these files")
gen_ineq <- st_read(here('HDR25_Composite_indices_complete_time_series.csv'))
paices <- st_read(here('World_Countries/World_Countries_Generalized.shp'))
```

```{r}
print("Let's inspect the data")
view(gen_ineq)
plot(paices)
```
```{r}
print('Okay, I see that in the paices data I want to remove antarctica because it is massive
      and in the gen_ineq I want to select only the columns containing country name,
      gii_2010 and gii_2019')

solo_paices <- paices %>% filter(COUNTRYAFF != 'AQ')
view(solo_paices)

gen_ineq2 <- gen_ineq %>% 
  select(any_of(c('country', 'gii_2010', 'gii_2019', 'iso3'))) 
view(gen_ineq2)
plot(solo_paices)
```

```{r}
print("Now I want to take the difference of the 2010 and 2019 gender inequality values
      A quick inspection of the table shows that the 2010 values are generally higher so 
      I will do (2010 value - 2019 value)")

gen_ineq_diff <- gen_ineq2 %>%
  mutate(
    gii_2010 = as.numeric(gii_2010),
    gii_2019 = as.numeric(gii_2019),
    difference = gii_2010 - gii_2019)
view(gen_ineq_diff)
```

```{r}
print("Alrighty it looks like imma have to work some magic to attain a key field in both
      datasets to execute a join. Let's investigate the countrycode package that Andy suggests")
print("Run this code [install.packages('countrycode')] in the console to install the package")
library(countrycode)

print('I am going to change the ISO3 values in gen_ineq_diff into ISO2 values similar to those in
      the solo_paices data')

gen_ineq_diff <- gen_ineq_diff %>%
  mutate(iso2 = countrycode(iso3, origin = 'iso3c', destination = 'iso2c'))
view(gen_ineq_diff)
```

```{r}
print("Badabing badaboom let's get crackalackin with the last bit of code now. I want to join
      the two datasets with the new columns that I have made!!")

gen_ineq_paices <- left_join(solo_paices, gen_ineq_diff, by = c('ISO' = 'iso2'))
view(gen_ineq_paices)
```

```{r}
print("SPECTACULAR! Now I want to clean up the final dataset so it is more easy to read")

gen_ineq_paices2 <- gen_ineq_paices %>%
  select(any_of(c('COUNTRY', 'gii_2010', 'gii_2019', 'difference', 'iso2', 
                  'geometry'))) %>%
  clean_names()
view(gen_ineq_paices2)
```

```{r}
print("Alright I just realized that there are regions included in this data like sub-saharan africa,
      let's remove those. I am going to filter all the areas without and ISO2 value")

print('gen_ineq_paices2 <- gen_ineq_paices2 %>%
  filter(!is.na(iso2))
view(gen_ineq_paices2)
plot(st_geometry(gen_ineq_paices2))')

## I switched the order of the join dataframes to mainetain the geometry so this is pointless
## good to know tho
```
```{r}
plot(gen_ineq_paices2)
```

```{r}
print('Alrighty I want to make a choropleth map of the difference in gender inquality by country!')

gen_ineq_map <- ggplot(gen_ineq_paices2) +
  geom_sf(aes(fill = difference), color = '#F0EAD6', size = 0.1) +
  scale_fill_gradient2(
    low = '#3c0008', mid = '#cc7070', high = '#ff69b4',
    midpoint = 0.1,
    name = "[2010-2019] GII"
  ) +
  theme_minimal() +
  labs(
    title = 'Difference in Gender Inequality Between 2019 and 2010',
    subtitle = 'Higher Numbers = Gender Equality Gains',
  )

plot(gen_ineq_map)
```

